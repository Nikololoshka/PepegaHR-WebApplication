{% extends 'workbase.html' %}
{% load static %}

<!-- header content -->
{% block title-content %}PepegaHR: profile{% endblock title-content %}

<!-- nav content -->
{% block profile-nav %}
<li class="bold active">
{% endblock profile-nav %}

{% block profile-body-nav %}
<div class="collapsible-body" style="display: block;">
{% endblock profile-body-nav %}

{% block profile-myprofile-nav %}
<li class="active">
{% endblock profile-myprofile-nav %}

<!-- main content -->
{% block main-content %}
<div class="card">
    <div class="card-content">
        <div class="row">
            <div class="col s12 center-align">
                <img src="{{ user.photo.url }}" class="circle" alt="" width="172px">
            </div>
        </div>
        <div class="row">
            <div class="col s12 center-align">
                <h5>{{ user.get_full_name }}</h5>
                <p>{{ user.get_role_display }}</p>
            </div>
        </div>
        <div class="divider"></div>
        <div class="row" style="margin-top: 20px;">
            <div class="col s12 xl6">
                <h6>Nickname: {{ user.username }}</h6>
            </div>
            <div class="col s12 xl6">
                <h6>Email: {{ user.email }}</h6>
            </div>
        </div>
        <div class="divider"></div>
        <div class="row" style="margin-top: 20px;">
            <div class="col s12 xl6">
                <h6>Последняя активность: {{ user.last_visit|date:"H:i:s, d/m/Y" }}</h6>
            </div>
            <div class="col s12 xl6 right-align">
                <button class="waves-effect waves-light btn edit-button">
                    <i class="material-icons left">edit</i>Редактировать профиль
                </button>
            </div>
        </div>
        <div class="row">
            <ul class="collapsible edit-row z-depth-0">
                <li>
                    <div class="collapsible-body">
                        <form action="{% url 'profile-edit' %}" method="POST" id="profile-edit-form">
                            {% csrf_token %}
                            <div class="row">
                                <div class="input-field col s12 xl6">
                                    <i class="material-icons prefix">assignment_ind</i>
                                    <input value="{{ user.username }}" id="nickname" type="text" class="validate" required>
                                    <label for="nickname">Nickname</label>
                                    <span class="helper-text" data-error="Не правильный формат поля"></span>
                                </div>
                                <div class="input-field col s12 xl6">
                                    <i class="material-icons prefix">email</i>
                                    <input value="{{ user.email }}" id="email" type="email" class="validate" required>
                                    <label for="email">Email</label>
                                    <span class="helper-text" data-error="Не правильный формат поля"></span>
                                </div>
                            </div>
                            <div class="row">
                                <div class="input-field col s12 xl6">
                                    <i class="material-icons prefix">lock</i>
                                    <input id="password" name="password" type="password" class="validate" 
                                           autocomplete="new-password">
                                    <label for="password">Новый пароль</label>
                                </div>
                                <div class="input-field col s12 xl6">
                                    <i class="material-icons prefix">lock</i>
                                    <input id="confirm_password" type="password" class="validate">
                                    <label for="confirm_password">Подтвердите пароль</label>
                                    <span class="helper-text" data-error="Пароли не совпадают"></span>
                                 </div>
                            </div>
                            <div class="row">
                                <div class="col s12 right-align">
                                    <button class="waves-effect waves-light btn" type="submit">Изменить</button>
                                </div>
                            </div>
                        </form>
                    </div>
                </li>
            </ul>
        </div>
    </div>
</div>

{% endblock main-content %}

{% block script-page %}
<script type="text/javascript" src="{% static '/userprofile/js/userprofile.js' %}"></script>
{% endblock script-page %}