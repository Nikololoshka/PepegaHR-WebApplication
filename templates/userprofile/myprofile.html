{% extends 'workbase.html' %}
{% load static %}

<!-- header content -->
{% block title-content %}PepegaHR: Профиль{% endblock title-content %}

<!-- nav content -->
{% block profile-nav %}
<li class="bold active">
{% endblock profile-nav %}

{% block profile-body-nav %}
<div class="collapsible-body" style="display: block;">
{% endblock profile-body-nav %}

{% block profile-myprofile-nav %}
<li class="active">
{% endblock profile-myprofile-nav %}

<!-- main content -->
{% block main-content %}
<div class="card">
    <div class="card-content">
        {% for error in hr_form.errors %}
        <p>{{ error }}</p>
        {% endfor %}
        <div class="row">
            <div class="col s12 center-align">
                <img src="{{ user.photo.url }}" class="circle" alt="" width="172px">
            </div>
        </div>
        <div class="row">
            <div class="col s12 center-align">
                <h5>{{ user.get_full_name }}</h5>
                <p>{{ user.get_role_display }}</p>
            </div>
        </div>
        <div class="divider"></div>
        <div class="row" style="margin-top: 20px;">
            <div class="col s12 xl6">
                <h6>Nickname: {{ user.username }}</h6>
                <h6>Email: {{ user.email }}</h6>
            </div>
            <div class="col s12 xl6">
                <h6>Группы:</h6>
                {% if user.departaments.all %}
                    {% for departament in user.departaments.all %}
                    <a href="{% url 'admin-departament-page' departament.id %}"><h6>{{ departament.name }}</h6></a>
                    {% endfor %}
                {% else %}
                    <h6>отсутствуют</h6>
                {% endif %}
            </div>
        </div>
        <div class="divider"></div>
        <div class="row" style="margin-top: 20px;">
            <div class="col s12 offset-xl6 xl6 right-align">
                <button class="waves-effect waves-light btn edit-button">
                    <i class="material-icons left">edit</i>Редактировать профиль
                </button>
            </div>
        </div>
        <div class="row">
            <ul class="collapsible edit-row z-depth-0">
                <li>
                    <div class="collapsible-body">
                        <form action="{% url 'my-profile' %}" method="POST" id="profile-edit-form">
                            {% csrf_token %}

                            <div class="row" style="margin-bottom: 0;">
                                <div class="input-field col s12 xl6">
                                    <i class="material-icons prefix">assignment_ind</i>
                                    {{ profile_form.username }}
                                    <span class="helper-text" data-error="Не правильный формат поля"></span>
                                    <label for="{{ profile_form.username.auto_id }}">{{ profile_form.username.label }}</label>
                                </div>
                                <div class="input-field col s12 xl6">
                                    <i class="material-icons prefix">email</i>
                                    {{ profile_form.email }}
                                    <span class="helper-text" data-error="Не правильный формат поля"></span>
                                    <label for="{{ profile_form.email.auto_id }}">{{ profile_form.email.label }}</label>
                                </div>
                            </div>

                            <div class="row" style="margin-bottom: 0;">
                                <div class="input-field col s12 xl6">
                                    <i class="material-icons prefix">lock</i>
                                    {{ profile_form.password }}
                                    <label for="{{ profile_form.password.auto_id }}">{{ profile_form.password.label }}</label>
                                </div>
                                <div class="input-field col s12 xl6">
                                    <i class="material-icons prefix">lock</i>
                                    {{ profile_form.password_confirm }}
                                    <label for="{{ profile_form.password_confirm.auto_id }}">{{ profile_form.password_confirm.label }}</label>
                                    <span class="helper-text" data-error="Пароли не совпадают"></span>
                                </div>
                            </div>

                            <div class="row">
                                <div class="col s12 right-align">
                                    <button class="waves-effect waves-light btn" type="submit">Изменить</button>
                                </div>
                            </div>
                        </form>
                    </div>
                </li>
            </ul>
        </div>
    </div>
</div>

{% endblock main-content %}

{% block script-page %}
<script type="text/javascript" src="{% static '/userprofile/js/userprofile.js' %}"></script>
{% endblock script-page %}