{% extends 'administration/users.html' %}
{% load static %}

<!-- header content -->
{% block title-content %}PepegaHR: Edit user{% endblock title-content %}

{% block head-page %}
<link rel="stylesheet" href="{% static '/administration/css/edit_user.css' %}">
{% endblock head-page %}

<!-- main content -->
{% block main-content %}
<div class="card">
    <div class="card-content">
        <span class="card-title">Редактирование пользователя</span>
        <!--
        <form method="POST" action="{% url 'admin-edit-user' hr_user.id %}" id="edit-user-form" enctype="multipart/form-data">
            {% csrf_token %}
            <div class="row valign-wrapper" style="margin-bottom: 0rem; display: flex;">
                <div class="file-field input-field" style="width: 100%; flex-grow: 1;">
                    <div class="btn">
                        <span><i class="material-icons">add_a_photo</i></span>
                        <input type="file" id="profile_image" name="profile_image">
                        <input type="hidden" id="profile_image_old" name="profile_image_old" value="{{ hr_user.photo.name }}">
                    </div>
                    <div class="file-path-wrapper" >
                        <input class="file-path validate" type="text" value="{{ hr_user.photo.name }}">
                    </div>
                </div>
                <a class="circle remove-photo" href="#" data-default="/media/user-photos/default.png">
                    <img src="{{ hr_user.photo.url }}" class="circle image-preview" alt="">
                </a>
            </div>
            <div class="row" style="margin-bottom: 0rem;">
                <div class="input-field col s12 l6">
                    <i class="material-icons prefix">person</i>
                    <input id="first_name" name="first_name" type="text" class="validate" pattern="[A-Za-zА-Яа-яЁё]+" 
                           autocomplete="name" required maxlength="30" value="{{ hr_user.first_name }}">
                    <span class="helper-text" data-error="Не правильный формат поля"></span>
                    <label for="first_name">Имя</label>
                </div>
                <div class="input-field col s12 l6">
                    <i class="material-icons prefix">person</i>
                    <input id="last_name" name="last_name" type="text" class="validate" pattern="[A-Za-zА-Яа-яЁё]+"
                           autocomplete="family-name" required maxlength="150" value="{{ hr_user.last_name }}">
                    <span class="helper-text" data-error="Не правильный формат поля"></span>
                    <label for="last_name">Фамилия</label>
                 </div>
            </div>
            <div class="row" style="margin-bottom: 0rem;">
                <div class="input-field col s12 l6">
                    <i class="material-icons prefix">assignment_ind</i>
                    <input id="nickname" name="nickname" type="text" class="validate" pattern="[A-Za-z\._]+[0-9]*"
                           autocomplete="nickname" required maxlength="50" value="{{ hr_user.username }}">
                    <span class="helper-text" data-error="Не правильный формат поля"></span>
                    <label for="nickname">Nickname</label>
                </div>
                <div class="input-field col s12 l6">
                    <i class="material-icons prefix">email</i>
                    <input id="email" name="email" type="email" class="validate" 
                           autocomplete="email" required value="{{ hr_user.email }}">
                    <span class="helper-text" data-error="Не правильный формат поля"></span>
                    <label for="email">Email</label>
                </div>
            </div>
            <div class="row" style="margin-bottom: 0rem;">
                <div class="input-field col s12 l6">
                    <i class="material-icons prefix">lock</i>
                    <input id="password" name="password" type="password" class="validate" 
                           autocomplete="new-password" minlength="8">
                    <label for="password">Новый пароль</label>
                </div>
                <div class="input-field col s12 l6">
                    <i class="material-icons prefix">lock</i>
                    <input id="confirm_password" name="confirm_password" type="password"
                           сlass="validate" minlength="8">
                    <label for="confirm_password">Подтвердите пароль</label>
                    <span class="helper-text" data-error="Пароли не совпадают"></span>
                 </div>
            </div>
            <div class="row">
                <div class="input-field col s12">
                    <i class="material-icons prefix">perm_identity</i>
                    <select id="role" name="role" >
                        {% for value, name in roles %}
                        <option value="{{ value }}" {% if value == hr_user.role %} selected {% endif %}>{{ name }}</option>
                        {% endfor %}
                    </select>
                    <label>Роль</label>
                  </div>
            </div>
        </form>
        -->
        <form method="POST" action="{% url 'admin-edit-user' hr_user.id %}" id="edit-user-form" enctype="multipart/form-data">
            {% csrf_token %}

            <div class="row valign-wrapper" style="margin-bottom: 0rem; display: flex;">
                <div class="file-field input-field" style="width: 100%; flex-grow: 1;">
                    <div class="btn">
                        <span><i class="material-icons">add_a_photo</i></span>
                        <input type="file" id="{{ hr_form.photo.auto_id }}" class="profile_image"
                               accept="image/*" name="{{ hr_form.photo.name }}">
                        <input type="hidden" id="photo_old" class="profile_image_old">
                    </div>
                    <div class="file-path-wrapper" >
                        <input class="file-path validate" type="text"
                               value="{{ hr_form.photo.value }}">
                    </div>
                </div>
                <a class="circle remove-photo" href="#" data-default="/media/user-photos/default.png">
                    <img src="{{ hr_user.photo.url }}" class="circle image-preview" alt="">
                </a>
            </div>

            <div class="row" style="margin-bottom: 0rem;">
                <div class="input-field col s12 l6">
                    <i class="material-icons prefix">person</i>
                    {{ hr_form.first_name }}
                    <span class="helper-text" data-error="Не правильный формат поля">
                        {% if hr_form.first_name.help_text %}
                        {{ hr_form.first_name.help_text }}
                        {% endif %}
                    </span>
                    <label for="{{ hr_form.first_name.auto_id }}">{{ hr_form.first_name.label }}</label>
                </div>
                <div class="input-field col s12 l6">
                    <i class="material-icons prefix">person</i>
                    {{ hr_form.last_name  }}
                    <span class="helper-text" data-error="Не правильный формат поля">
                        {% if hr_form.last_name.help_text %}
                        {{ hr_form.last_name.help_text }}
                        {% endif %}
                    </span>
                    <label for="{{ hr_form.last_name.auto_id }}">{{ hr_form.last_name.label }}</label>
                 </div>
            </div>

            <div class="row" style="margin-bottom: 0rem;">
                <div class="input-field col s12 l6">
                    <i class="material-icons prefix">assignment_ind</i>
                    {{ hr_form.username }}
                    <span class="helper-text" data-error="Не правильный формат поля">
                        {% if hr_form.username.help_text %}
                        {{ hr_form.username.help_text }}
                        {% endif %}
                    </span>
                    <label for="{{ hr_form.username.auto_id }}">{{ hr_form.username.label }}</label>
                </div>
                <div class="input-field col s12 l6">
                    <i class="material-icons prefix">email</i>
                    {{ hr_form.email }}
                    <span class="helper-text" data-error="Не правильный формат поля">
                        {% if hr_form.email.help_text %}
                        {{ hr_form.email.help_text }}
                        {% endif %}
                    </span>
                    <label for="{{ hr_form.email.auto_id }}">{{ hr_form.email.label }}</label>
                </div>
            </div>

            <div class="row" style="margin-bottom: 0rem;">
                <div class="input-field col s12 l6">
                    <i class="material-icons prefix">lock</i>
                    {{ hr_form.password }}
                    <label for="{{ hr_form.password.auto_id }}">{{ hr_form.password.label }}</label>
                </div>
                <div class="input-field col s12 l6">
                    <i class="material-icons prefix">lock</i>
                    {{ hr_form.password_confirm }}
                    <label for="{{ hr_form.password_confirm.auto_id }}">{{ hr_form.password_confirm.label }}</label>
                    <span class="helper-text" data-error="Пароли не совпадают"></span>
                 </div>
            </div>

            <div class="row">
                <div class="input-field col s12">
                    <i class="material-icons prefix">perm_identity</i>
                    {{ hr_form.role }}
                    <label>{{ hr_form.role.label }}</label>
                  </div>
            </div>
        </form>
    </div>
    <div class="card-action">
        <div>
            <a href="{% url 'admin-users-page' %}" class=" btn-flat waves-effect waves-light">Отмена</a>
            <button form="edit-user-form" class="btn waves-effect waves-light" type="submit" >Изменить</button>
        </div>
    </div>
</div>
{% endblock main-content %}

{% block script-page %}
<script type="text/javascript" src="{% static '/administration/js/edit_user.js' %}"></script>
{% endblock script-page %}